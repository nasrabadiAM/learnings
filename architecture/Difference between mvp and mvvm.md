Difference between mvp and mvvm
---
تفاوت اصلی این دو پترن در این است که رابطه بین ویو و پرزنتر یک به یک است درصورتی که رابطه بین ویو و ویو‌مدل یک به چند است، یعنی هر ویو می‌تواند چندین ویو‌مدل داشته باشد.
تفاوت دیگر آن است که پرزنتر رفرنسی از ویو را در خود نگه‌می‌دارد تا بتواند اطلاعاتی که از مدل می‌گیرد را با متد‌کال در ویو آپدیت کند، درصورتی که ویومدل رفرنسی به ویو ندارد و فقط ویو است که رفرنس ویو‌مدل را دارد و اطلاعات ویو‌مدل را observe  می‌کند. 
این observe کردن می‌تواند به هر روشی و با استفاده از هر ابزاری پیاده شود، خواه دیتابایندینگ باشد یا لایو‌دیتا، یا rx و یا خود Observer Pattern.





پترن‌هایی مثل MVC  و یا ...  در هر جایی که استفاده می‌شوند ایده‌هایی جداگانه ازشان برداشت می‌شود، همین باعث گنگ شدن این موضوع می‌شود و هر کس تعریف خودش را از آن خواهد داشت.
 

ایده MVC این بود که UI برنامه از لاجیک آن جدا شود چرا که ترکیب‌ این دو در فرم‌ها کار راحتی نبود و تغییر آن‌ها بسیار سخت بود. اما مشکلی که به وجود می‌آمد، مشکل در Synchroniziation برنامه و ui  آن بود. اینجا بود که ایده‌ای به نام databinding به وجود آمد.  ایده آن بود که هر تغییری در برنامه به سرعت به تمام برنامه propagate  شود.
تا همه برنامه از تغییرات به وجود آمده با خبر باشند.

MVC:
 
مدل (Model): مدل‌ها، داده، وضعیت و بیزینس‌لاجیک برنامه را مدیریت می‌کنند.

ویو: وظیفه نمایش ui و ارتباط برقرار کردن با کنترلر را در زمانی که کاربر با اپلیکیشن کار می‌کند را دارد.

کنترلر: واسطه بین ویو و مدل است و مثلا زمانیکه کاربر روی‌ دکمه‌ای کلیک می‌کند این وظیفه کنترلر است که با مدل ارتباط برقرار کند و فقط او هست که می‌داند چطور باید با آن ارتباط برقرار کند.
 
در یک برنامه اندرویدی ویو فایل‌های xml ما هستند و کنترلر اکتیویتی یا فرگمنت ما و مدل هم یک کلاس domain هست.

در این پترن مدل به خوبی از ویو جدا شده و می‌توانیم آن را تست کنیم.

اما کنترلر مشکلاتی را ایجاد خواهد کرد: 
۱-تست‌پذیری: کنترلر به شدت به ویو در اندروید وابسته است و این تست کردن کنترلر را سخت خواهد کرد.
۲-ماژولاریتی و انعطاف‌پذیری: اگر بخواهیم ویو را تغییر دهیم به احتمال خیلی زیاد باید کنترلر را هم تغییر دهیم و این بد است.
۳-در طول زمان کدهای بیشتری به کنترلر  منتقل خواهد شد و این maintenance برنامه را سخت تر خواهد کرد.

//عکس

MVP:
 
مدل: در این پترن مدل دقیقا همان مدلی است که در MVC وجود داشت و همان کارها را هم انجام می دهد.

ویو: تنها تغییری که در MVP  در مقایسه با MVCبه وجود می‌آید، این است که اکتیویتی و فرگمنت جزیی از ویو خواهند بود.
یعنی پرزنتر در اینجا یک اینترفیس خواهد داشت و کاملا از ویو و هر کامپوننت دیگر اندرویدی جدا خواهد شد.
و نباید هیچ رفرنسی به هیچ api اندرویدی داشته باشد. مثل کانتکست

همچنین ویو هم باید یک اینترفیس داشته باشد تا بتوانیم این دو را از هم جدا کنیم.

//عکس 

با MVP تا حد خوبی پرزنتر را از اندروید جدا می کنیم و این‌کار باعث می‌شود تا مشکلاتی که با کنترلر  MVC داشتیم برطرف شود.

 
مشکلات پرزنتر: 
نگه‌داری یا maintenance:  مشکلی که هنوز وجود دارد، مشکل نگهداری است، چرا که بعد از مدتی دولوپر کد را طوری می‌بیند که کلی پرزنتر دارد که نمی‌توانند به هیچ وجه از ویو‌ها جدا شوند.
  
MVVM: 

مدل: همان مدلی است که در MVC و MVP وجود داشت.

ویو: در اینجا با یک ری‌اکتیو پترن با ویومدل در ارتباط است و هر تغییری در مدل ایجاد شود به سریعا ویو از طریق ویو‌مدل با خبر می‌شود.

ویو مدل: ویو مدل یک با یک ری اکتیو پترنی همه تغییرات را منتشر میکند تا ویو‌ها مطلع شوند.

نکته‌ای که در اینجا وجود دارد، این است که در mvp  ما به ازای هر ویو یک پرزنتر داریم و ارتباط بین ویو و پرزنتر یک به یک است. 
اما در mvvm ارتباط بین ویو و ویومدل یک به n است، یعنی هر ویو می‌تواند چندین ویومدل داشته باشد. و هر ویومدل در چندین ویو مورد استفاده قرار بگیرد.

تفاوت دیگر در آن است که در mvp  هر پرزنتر یک رفرنس به ویو دارد تا بتواند تغییرات را اطلاع بدهد، اما در mvvm  ویومدل هیچ رفرنسی به ویو ندارد و تغییرات از طریق یک observer patternای به هر ویویی که subscribe کرده باشد، اطلاع‌رسانی خواهد شد.
 
 


منابع
---

https://martinfowler.com/eaaDev/uiArchs.html

https://academy.realm.io/posts/eric-maxwell-mvc-mvp-and-mvvm-on-android/

http://www.differencebetween.net/technology/difference-between-mvvm-and-mvp/
