What is Activity?
---

اکتیویتی چیست؟
---


اکتیویتی‌ها یکی از بلاک‌های سازنده اپلیکیشن‌های اندرویدی هستند، هر صفحه در اپلیکیشن‌ها حتما یک اکتیویتی است.

اکتیوتی چیزی فراتراز یک کلاس‌ جاوا در فریمورک اندروید نیست که رابط کاربری اپلیکیشن‌ها را می‌سازد. 

مثل اپلیکیشن‌های جاوا که از متد main() شروع می‌شوند، اغلب اپلیکیشن‌های اندرویدی هم از یک اکتیوتی‌ شروع می‌شوند و می‌توانیم بعد از آن چند اکتیویتی دیگر داشته باشیم.





کار نمونه‌سازی اکتیوتی‌ها و مدیریت‌ آن‌ها به عهده سیستم‌عامل اندروید است. یعنی خود اندروید آن‌ها را مدیریت می‌کند و ما فقط می‌توانیم درخواست خود را برای استفاده از آن‌ها به وسیله Intentها به اندروید بفرستیم و اندروید کار موردنظر را برای انجام دهد.



استفاده از اکتیوتی‌ها و اینتنت‌ها به اندروید این امکان را می‌دهد که از آخرین اینتنت‌های اجرا شده و در واقع از آخرین اولیت‌های کاربر آگاهی داشته باشد و بتواند براساس آن منابع را مدیریت کند.



چرخه حیات
---

هر چیزی دارای یک چرخه حیات است، روزی به وجود می‌آید و روزی هم ازبین می‌رود. اکتیوتی‌ها هم از این قاعده مستثنا نیستند. یک زمانی در ram(حافظه) به وجود می‌آیند و یک زمانی هم از آن پاک شده و ازبین می‌روند.

این چرخه حیات به شکل زیر است:


عکس چرخه حیات








اکتیویتی‌ها در مانیفست
---
هر اکتیوتی که در برنامه استفاده می‌شود باید حتما در Manifest برنامه شما معرفی شود تا اندروید اجازه استفاده از آن (launch  شدن) را به شما بدهد.

می‌توانیم برای اکتیوتی‌ها در مانیفست اطلاعاتی را درج کنیم و با آن اطلاعات به اندروید بگوییم که این اکتیویتی در برنامه ما چه وظیفه‌ای دارد. 

مثلا زمانی که یک برنامه اندرویدی درخواست استفاده از یک برنامه ایمیل را برای ارسال ایمیل می‌دهد، در واقع دارد با استفاده از اینتنت‌ها یک اکتیوتی از برنامه‌ای دیگر که به عنوان اکتیویتی ارسال ایمیل معرفی شده است را اجرا می‌کند. 



دلیل آنکه آن اکتیویتی در برنامه ایمیل به عنوان اکتیوتی ارسال ایمیل معرفی شده است،‌ اطلاعات اضافه‌ای است که درباره آن اکتیویتی در مانیفست برنامه ایمیل نوشته شده است.





Intent Filterها 
---

اینتنت‌فیلتر‌ها ابزار‌های قدرتمندی برای اجرای نه تنها اینتنت‌های مستقیم است بلکه برای اینتنت‌های غیرمستقیم هم استفاده می‌شود.



مثل همان اینتنتی که برای ارسال ایمیل زدیم، اینبار فرض کنید به جای آنکه بگوییم دقیقا اکتیوتی ارسال ایمیل یک اپلیکیشن خاص را اجرا کند(explicit request)،‌ می‌گوییم تا اکتیوتی ارسال ایمیل را در هر اکتیوتی و در هر برنامه‌‌ای که در گوشی وجود دارد و این قابلیت را دارد(implicit request)، اجرا کند. 

در این زمان است که دیالوگ یا باتن‌شیت انتخاب اپلیکیشن‌ می‌آید و می‌توانیم از بین اپلیکیشن‌های موجود یکی را انتخاب کنیم.





نحوه تغریف اکتیویتی با implicit request به صورت زیر است.

```xml
‍‍<activity android:name=".ExampleActivity" android:icon="@drawable/app_icon">
    <intent-filter>
        <action android:name="android.intent.action.SEND" />
        <category android:name="android.intent.category.DEFAULT" />
        <data android:mimeType="text/plain" />
    </intent-filter>
</activity>
```

حداقل attr لازم برای تعریف یک اکتیویتی نام کلاس آن اکتیوتی در برنامه است.



اما می‌توانیم مقادیر دیگری را هم به آن بدهیم: مثل



  <action> کاری که می‌تواند انجام دهد.



 <category>  اگر DEFAULT  باشد، به اکتیوتی اجازه دریافت درخواست‌های اجرا را می‌دهد.



و  <data> هم نوع داده‌ای که می تواند ارسال کند را مشخص می‌کند.



کد جاوای اجرای چنین اکتیوتی به صورت زیر است:


```java
// Create the text message with a string
Intent sendIntent = new Intent();
sendIntent.setAction(Intent.ACTION_SEND);
sendIntent.setType("text/plain");
sendIntent.putExtra(Intent.EXTRA_TEXT, textMessage);
// Start the activity
startActivity(sendIntent);
```

اگر برنامه‌اتان را طوری طراحی کردید که فقط باید از داخل برنامه آن کار را انجام دهد، به هیچ‌وجه نباید این اطلاعات را در مانیفست بنویسید. بلکه باید از داخل خود برنامه اینتنت را اجرا کنید.






تعریف permissionها: 
---


می‌توانیم از تگ اکیتویتی در مانیفست برای تعریف پرمیشن‌های جدید استفاده کنیم. 

در این صورت اگر اپ دیگری این پرمیشن را نگیرد، نمی‌تواند آن اکتیوتی را لانچ کند.


```xml
<manifest>
<activity android:name="...."
   android:permission=”com.google.socialapp.permission.SHARE_POST”

/>
```


```xml
<manifest>
   <uses-permission android:name="com.google.socialapp.permission.SHARE_POST" />
</manifest>
```








منابع
---

https://developer.android.com/guide/components/activities/intro-activities


https://academy.realm.io/posts/activities-in-the-wild-exploring-the-activity-lifecycle-android/


https://www.bignerdranch.com/blog/android-activity-lifecycle-onStop/


https://developer.android.com/guide/components/activities/activity-lifecycle


https://medium.com/google-developers/the-android-lifecycle-cheat-sheet-part-i-single-activities-e49fd3d202ab


https://medium.com/sketchware/activity-lifecycle-in-android-applications-1b48a7bb584c
